@page
@model BusLiner.MVC.Areas.Administration.Pages.Rides.AllRidesModel


<div class="tickets-content__title">
    <div class="tickets-content__title-create">
        <button class="tickets-content__title-create-create_ride"><a asp-page="./CreateRide">Створити поїздку</a></button>
    </div>
    <div class="tickets-content__title-sortby-button">
        <button class="tickets-content__title-sortby-button-button">Сортувати по  <i class="fa-solid fa-gears"></i></button>
    </div>
</div>
<div class="tickets-content__sort-options">
    <button class="tickets-content__sort-options-button departure-time">Відправлення  <i class="fa-solid fa-chevron-down"></i></button>
    <button class="tickets-content__sort-options-button arrive-time">Прибуття  <i class="fa-solid fa-chevron-down"></i></button>
    <button class="tickets-content__sort-options-button travel-time">Час в дорозі  <i class="fa-solid fa-chevron-down"></i></button>
    <button class="tickets-content__sort-options-button price">Ціна  <i class="fa-solid fa-chevron-down"></i></button>
    <button class="tickets-content__sort-options-button tickets-left">Квитки  <i class="fa-solid fa-chevron-down"></i></button>
</div>
<div class="tickets-content__tickets">
    <div class="tickets-content__tickets">
        @foreach (Ride ride in Model.Rides)
        {
            var departureTime = Regex.Replace(ride.DepartureTime.ToString("dd MMM, ddd"), @"\.(.)|\b(.)", m => m.Groups[1].Success ? m.Groups[1].Value : m.Groups[2].Value.ToUpper());
            var arrivalTime = Regex.Replace(ride.ArrivalTime.ToString("dd MMM, ddd"), @"\.(.)|\b(.)", m => m.Groups[1].Success ? m.Groups[1].Value : m.Groups[2].Value.ToUpper());

            <div class="tickets-content__tickets-ticket">
                <div class="tickets-content__tickets-ticket-content">
                    <div class="tickets-content__tickets-ticket-places">
                        <div class="tickets-content__tickets-ticket-places-from">
                            <div class="tickets-content__tickets-ticket-places-from-city">@ride.DeparturePlace.City</div>
                            <div class="tickets-content__tickets-ticket-places-from-station">@ride.DeparturePlace.Station</div>
                            <div class="tickets-content__tickets-ticket-places-from-street">@ride.DeparturePlace.Street</div>
                        </div>
                        <div class="tickets-content__tickets-ticket-places-to">
                            <div class="tickets-content__tickets-ticket-places-to-city">@ride.ArrivalPlace.City</div>
                            <div class="tickets-content__tickets-ticket-places-to-station">@ride.ArrivalPlace.Station</div>
                            <div class="tickets-content__tickets-ticket-places-to-street">@ride.ArrivalPlace.Street</div>
                        </div>
                    </div>
                    <div class="tickets-content__tickets-ticket-when">
                        <div class="tickets-content__tickets-ticket-when-from_time">
                            <div class="tickets-content__tickets-ticket-when-from_time-time">@ride.DepartureTime.ToString("HH:mm") <i class="fa-solid fa-van-shuttle"></i></div>
                            <div class="tickets-content__tickets-ticket-when-from_time-day">@departureTime</div>
                        </div>
                        <div class="tickets-content__tickets-ticket-when-line"></div>
                        <div class="tickets-content__tickets-ticket-when-time_in_trip">
                            <div class="tickets-content__tickets-ticket-when-time_in_trip-icon"><i class="fa-regular fa-clock"></i></div>
                            <div class="tickets-content__tickets-ticket-when-time_in_trip-time">@((ride.ArrivalTime - ride.DepartureTime).ToString("hh\\:mm"))</div>
                        </div>
                        <div class="tickets-content__tickets-ticket-when-line"></div>
                        <div class="tickets-content__tickets-ticket-when-to_time">
                            <div class="tickets-content__tickets-ticket-when-to_time-time"><i class="fa-solid fa-location-dot"></i> @ride.ArrivalTime.ToString("HH:mm")</div>
                            <div class="tickets-content__tickets-ticket-when-to_time-day">@arrivalTime</div>
                        </div>
                    </div>
                </div>
                <div class="tickets-content__tickets-ticket-buy">
                    <div class="tickets-content__tickets-ticket-buy-price">@ride.Price.ToString("F2") грн</div>
                    <div class="tickets-content__tickets-ticket-buy-form">
                        <div class="tickets-content__tickets-ticket-buy-form-button tickets-content__tickets-ticket-buy-form-button-admin">
                            <a asp-page="./UpdateRide" asp-route-RideId="@ride.Id">Змінити</a>
                        </div>
                        <form method="post">
                            <input type="hidden" name="RideId" value="@ride.Id" />
                            <button class="tickets-content__tickets-ticket-buy-form-button tickets-content__tickets-ticket-buy-form-button-admin tickets-content__tickets-ticket-buy-form-button-admin-delete" type="submit">
                                <a>Видалити</a>
                            </button>
                        </form>
                        <div class="tickets-content__tickets-ticket-buy-form-tickets_left">Залишилось квитків: @ride.TicketsAvailable шт.</div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

